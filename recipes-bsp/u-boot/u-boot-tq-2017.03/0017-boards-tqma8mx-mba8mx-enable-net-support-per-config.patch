From 67b91aafd549839f66ef5116cd6ff71ad3f34c8b Mon Sep 17 00:00:00 2001
From: Markus Niebel <Markus.Niebel@tq-group.com>
Date: Thu, 17 Jan 2019 09:57:08 +0100
Subject: [PATCH] boards: tqma8mx-mba8mx: enable net support per config

Signed-off-by: Markus Niebel <Markus.Niebel@tq-group.com>
---
 board/tqc/tqma8mx/Kconfig            |  9 +++++++++
 configs/tqma8mq_mba8mx_mmc_defconfig |  3 ---
 include/configs/tqma8mx-mba8mx.h     | 14 ++++++++++++++
 3 files changed, 23 insertions(+), 3 deletions(-)

diff --git a/board/tqc/tqma8mx/Kconfig b/board/tqc/tqma8mx/Kconfig
index 8348b011ee..9d5764c98c 100644
--- a/board/tqc/tqma8mx/Kconfig
+++ b/board/tqc/tqma8mx/Kconfig
@@ -31,6 +31,15 @@ choice
 config MBA8MX
 	bool "TQMa8MX on MBa8MX Starterkit"
 	select TQC_SDMMC
+	select MII
+	select CMD_MII
+	select CMD_PING
+	select CMD_DHCP
+	select CMD_NET
+	select DM_ETH
+	select FEC_MXC
+	select PHYLIB
+	select PHY_TI
 	help
 	  Select the MBa8MX starterkit. This features a GigE Phy, USB, SD-Card
 	  etc.
diff --git a/configs/tqma8mq_mba8mx_mmc_defconfig b/configs/tqma8mq_mba8mx_mmc_defconfig
index d1c117dd47..f4aa20a52f 100644
--- a/configs/tqma8mq_mba8mx_mmc_defconfig
+++ b/configs/tqma8mq_mba8mx_mmc_defconfig
@@ -12,12 +12,9 @@ CONFIG_CMD_MEMTEST=y
 CONFIG_CMD_MEMINFO=y
 CONFIG_CMD_I2C=y
 CONFIG_CMD_GPIO=y
-# CONFIG_CMD_NET is not set
-# CONFIG_CMD_NFS is not set
 CONFIG_CMD_CACHE=y
 CONFIG_CMD_TIME=y
 CONFIG_CMD_UBI=y
 CONFIG_OF_CONTROL=y
 CONFIG_SYS_I2C_MXC=y
 CONFIG_NXP_TMU=y
-CONFIG_REGEX=y
diff --git a/include/configs/tqma8mx-mba8mx.h b/include/configs/tqma8mx-mba8mx.h
index 54958cfac5..9226fff01f 100644
--- a/include/configs/tqma8mx-mba8mx.h
+++ b/include/configs/tqma8mx-mba8mx.h
@@ -7,6 +7,20 @@
 #if !defined(__TQMA8MX_MBA8MX_H)
 #define __TQMA8MX_MBA8MX_H
 
+/* ENET Config */
+/* ENET1 */
+#if defined(CONFIG_CMD_NET)
+
+#define CONFIG_MII
+#define CONFIG_ETHPRIME			"FEC"
+
+#define CONFIG_FEC_XCV_TYPE		RGMII
+#define CONFIG_FEC_MXC_PHYADDR		0
+#define FEC_QUIRK_ENET_MAC
+
+#define CONFIG_PHY_GIGE
+#endif
+
 #if !defined(CONFIG_SPL_BUILD)
 #define CONFIG_DM_GPIO
 #define CONFIG_DM_PCA953X
