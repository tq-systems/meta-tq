From d20d45936b71631b591953fc5cd6d0145f6ec4d9 Mon Sep 17 00:00:00 2001
From: Markus Niebel <Markus.Niebel@tq-group.com>
Date: Wed, 16 Jan 2019 10:54:07 +0100
Subject: [PATCH 23/24] arm: dt: tqma8mq-mba8mx: add ethernet

Signed-off-by: Markus Niebel <Markus.Niebel@tq-group.com>
---
 arch/arm/dts/fsl-imx8mq-tqma8mq-mba8mx.dts | 29 +++++++++++++++++-----
 1 file changed, 23 insertions(+), 6 deletions(-)

diff --git a/arch/arm/dts/fsl-imx8mq-tqma8mq-mba8mx.dts b/arch/arm/dts/fsl-imx8mq-tqma8mq-mba8mx.dts
index 77bac828be..c5e97f7084 100644
--- a/arch/arm/dts/fsl-imx8mq-tqma8mq-mba8mx.dts
+++ b/arch/arm/dts/fsl-imx8mq-tqma8mq-mba8mx.dts
@@ -17,6 +17,7 @@
 /dts-v1/;
 
 #include "fsl-imx8mq-tqma8mq.dtsi"
+#include <dt-bindings/net/ti-dp83867.h>
 
 / {
 	model = "TQ Systems GmbH i.MX8MQ TQMa8MQ on MBa8MX";
@@ -155,24 +156,40 @@
 	phy-mode = "rgmii-id";
 	phy-handle = <&ethphy0>;
 	fsl,magic-packet;
+	phy-reset-gpios = <&expander2 7 GPIO_ACTIVE_LOW>;
+	phy-reset-duration = <500>;
 	status = "okay";
 
 	mdio {
 		#address-cells = <1>;
 		#size-cells = <0>;
 
-		ethphy0: ethernet-phy@0 {
+		ethphy0: ethernet-phy@e {
 			compatible = "ethernet-phy-ieee802.3-c22";
-			reg = <0>;
-			at803x,led-act-blind-workaround;
-			at803x,eee-disabled;
+			reg = <0x0e>;
+			ti,rx-internal-delay = <DP83867_RGMIIDCTL_2_50_NS>;
+			ti,tx-internal-delay = <DP83867_RGMIIDCTL_2_50_NS>;
+			ti,dp83867-rxctrl-strap-quirk;
+			ti,led-function = <0xc100>; /* LED1: Link, LED2: activity */
+			ti,led-ctrl = <0x1001>;     /* active low, LED1/2 driven by phy */
 		};
 	};
 };
 
 &i2c1 {
-	clock-frequency = <100000>;
-	status = "okay";
+	expander1: pca9555@24 {
+		compatible = "nxp,pca9555";
+		reg = <0x24>;
+		gpio-controller;
+		#gpio-cells = <2>;
+	};
+
+	expander2: pca9555@25 {
+		compatible = "nxp,pca9555";
+		reg = <0x25>;
+		gpio-controller;
+		#gpio-cells = <2>;
+	};
 };
 
 &i2c2 {
-- 
2.17.1

