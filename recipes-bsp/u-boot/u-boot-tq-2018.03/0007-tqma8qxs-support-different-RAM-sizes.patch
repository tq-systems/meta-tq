From cda73b38de8a6332607e283247595e786b924dd8 Mon Sep 17 00:00:00 2001
From: Markus Niebel <Markus.Niebel@tq-group.com>
Date: Wed, 17 Apr 2019 19:08:58 +0200
Subject: [PATCH] tqma8qxs: support different RAM sizes

Signed-off-by: Markus Niebel <Markus.Niebel@tq-group.com>
---
 board/tqc/tqma8qxs/Kconfig | 23 +++++++++++++++++++++++
 include/configs/tqma8qxs.h | 12 +++++++++++-
 2 files changed, 34 insertions(+), 1 deletion(-)

diff --git a/board/tqc/tqma8qxs/Kconfig b/board/tqc/tqma8qxs/Kconfig
index 08ff2340fb..4b9e5be7e5 100644
--- a/board/tqc/tqma8qxs/Kconfig
+++ b/board/tqc/tqma8qxs/Kconfig
@@ -27,6 +27,29 @@ config TQMA8QXS_CPU_MX8DX
 
 endchoice
 
+choice
+	prompt "TQMa8XxS RAM size"
+	default TQMA8QXS_RAM_1014MB if TQMA8QX_CPU_MX8QXP
+	default TQMA8QXS_RAM_512MB if TQMA8QXS_CPU_MX8DX
+	help
+	  Select RAM size for TQMa8XxS
+
+config TQMA8QXS_RAM_512MB
+	bool "TQMa8XxS with 512 MiB RAM"
+	help
+	  Select variant with 512 MiB RAM
+
+config TQMA8QXS_RAM_1014MB
+	bool "TQMa8XxS with 1024 MiB RAM"
+	help
+	  Select variant with 1024 MiB RAM
+
+config TQMA8QXS_RAM_2048MB
+	bool "TQMa8XxS with 2048 MiB RAM"
+	help
+	  Select variant with 2048 MiB RAM
+
+endchoice
 
 choice
 	prompt "TQMa8QXS base board variant"
diff --git a/include/configs/tqma8qxs.h b/include/configs/tqma8qxs.h
index c9b1aca714..74a5ede6c6 100644
--- a/include/configs/tqma8qxs.h
+++ b/include/configs/tqma8qxs.h
@@ -303,7 +303,17 @@
 #define CONFIG_SYS_SDRAM_BASE		0x80000000
 #define CONFIG_NR_DRAM_BANKS		1
 #define PHYS_SDRAM_1			0x80000000
-#define PHYS_SDRAM_1_SIZE		SZ_1G	/* 1 GB */
+
+#if defined(CONFIG_TQMA8QXS_RAM_512MB)
+#define PHYS_SDRAM_1_SIZE		SZ_512M
+#elif defined(CONFIG_TQMA8QXS_RAM_1014MB)
+#define PHYS_SDRAM_1_SIZE		SZ_1G
+#elif defined(CONFIG_TQMA8QXS_RAM_2048MB)
+#define PHYS_SDRAM_1_SIZE		SZ_2G
+#else
+#error
+#endif
+
 /* needed for loop in CPU code */
 #define PHYS_SDRAM_2			0x800000000
 #define PHYS_SDRAM_2_SIZE		0x0000000	/* not placed */
