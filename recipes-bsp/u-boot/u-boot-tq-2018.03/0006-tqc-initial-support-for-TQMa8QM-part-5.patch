From 5652d34130d6e64db3b885f399f5edc10aba9e88 Mon Sep 17 00:00:00 2001
From: Markus Niebel <Markus.Niebel@tq-group.com>
Date: Tue, 10 Sep 2019 16:33:16 +0200
Subject: [PATCH] tqc: initial support for TQMa8QM - part 5

Signed-off-by: Markus Niebel <Markus.Niebel@tq-group.com>
---
 board/tqc/tqma8x/Kconfig       | 2 +-
 include/configs/tqma8x-mba8x.h | 3 ++-
 include/configs/tqma8x.h       | 3 ++-
 3 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/board/tqc/tqma8x/Kconfig b/board/tqc/tqma8x/Kconfig
index 58853bd4bf..4616676900 100644
--- a/board/tqc/tqma8x/Kconfig
+++ b/board/tqc/tqma8x/Kconfig
@@ -55,7 +55,7 @@ config DEFAULT_DEVICE_TREE
 	default "fsl-imx8qm-tqma8qm-mba8x" if TQMA8X_CPU_MX8QM && TQMA8X_BB_MBA8X
 
 config DEFAULT_FDT_FILE
-	default "fsl-imx8qm-tqma8qm-mba8x" if TQMA8X_CPU_MX8QM && TQMA8X_BB_MBA8X
+	default "fsl-imx8qm-tqma8qm-mba8x.dtb" if TQMA8X_CPU_MX8QM && TQMA8X_BB_MBA8X
 
 choice
 	prompt "TQMa8x boot device"
diff --git a/include/configs/tqma8x-mba8x.h b/include/configs/tqma8x-mba8x.h
index dbfdc861a8..49c2e992a7 100644
--- a/include/configs/tqma8x-mba8x.h
+++ b/include/configs/tqma8x-mba8x.h
@@ -23,7 +23,8 @@
 #define CONFIG_FEC_MXC_PHYADDR		0x1F
 
 #define BB_ENV_SETTINGS \
-	"console=ttyLP1,115200 earlycon=lpuart32,5a070000,115200\0" \
+	"console=ttyLP0,"__stringify(CONFIG_BAUDRATE)"\0" \
+	"earlycon=lpuart32,5a060000,"__stringify(CONFIG_BAUDRATE)"\0" \
 	"fdt_file=" CONFIG_DEFAULT_FDT_FILE "\0"
 
 #endif /* __TQMA8X_MBA8X_H */
diff --git a/include/configs/tqma8x.h b/include/configs/tqma8x.h
index d9915c0abb..c5aef8afdc 100644
--- a/include/configs/tqma8x.h
+++ b/include/configs/tqma8x.h
@@ -240,7 +240,8 @@
 		"fi; \0"                                                       \
 	"rootfsmode=ro\0"                                                      \
 	"addtty=setenv bootargs ${bootargs} console=${console}\0"              \
-	"mmcargs=run addmmc addtty\0"                                          \
+	"addearlycon=setenv bootargs ${bootargs} earlycon=${earlycon}\0"       \
+	"mmcargs=run addmmc addtty addearlycon\0"                              \
 	"mmcrootpart=2\0"                                                      \
 	"addmmc=setenv bootargs ${bootargs} "                                  \
 		"root=/dev/mmcblk${mmcblkdev}p${mmcrootpart} ${rootfsmode} "   \
