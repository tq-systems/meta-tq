From 0b1472f88fbc6a5acbe500e8accbeaa8d6380389 Mon Sep 17 00:00:00 2001
From: Markus Niebel <Markus.Niebel@tq-group.com>
Date: Thu, 17 Jan 2019 17:28:52 +0100
Subject: [PATCH] tqma8mq_mba8mx: improve config

move more things to defconfig

Signed-off-by: Markus Niebel <Markus.Niebel@tq-group.com>
---
 board/tqc/tqma8mx/Kconfig            |  7 +++++++
 configs/tqma8mq_mba8mx_mmc_defconfig |  4 +++-
 include/configs/tqma8mx.h            | 17 ++++++++++++-----
 3 files changed, 22 insertions(+), 6 deletions(-)

diff --git a/board/tqc/tqma8mx/Kconfig b/board/tqc/tqma8mx/Kconfig
index 9d5764c98c..c0e355976e 100644
--- a/board/tqc/tqma8mx/Kconfig
+++ b/board/tqc/tqma8mx/Kconfig
@@ -40,6 +40,13 @@ config MBA8MX
 	select FEC_MXC
 	select PHYLIB
 	select PHY_TI
+	select CMD_MMC
+	select CMD_SF
+	select CMD_FAT
+	select CMD_EXT2
+	select CMD_EXT4
+	select CMD_EXT4_WRITE
+	select CONFIG_DOS_PARTITION
 	help
 	  Select the MBa8MX starterkit. This features a GigE Phy, USB, SD-Card
 	  etc.
diff --git a/configs/tqma8mq_mba8mx_mmc_defconfig b/configs/tqma8mq_mba8mx_mmc_defconfig
index eefdf782ba..2da67b7d4a 100644
--- a/configs/tqma8mq_mba8mx_mmc_defconfig
+++ b/configs/tqma8mq_mba8mx_mmc_defconfig
@@ -19,8 +19,10 @@ CONFIG_CMD_CACHE=y
 CONFIG_CMD_TIME=y
 CONFIG_CMD_PMIC=y
 CONFIG_CMD_REGULATOR=y
+CONFIG_CMD_FS_GENERIC=y
 CONFIG_CMD_UBI=y
-# CONFIG_DOS_PARTITION is not set
+CONFIG_EFI_PARTITION=y
+# CONFIG_SPL_EFI_PARTITION is not set
 CONFIG_OF_CONTROL=y
 CONFIG_ENV_IS_IN_MMC=y
 CONFIG_IMX8M_LPDDR4=y
diff --git a/include/configs/tqma8mx.h b/include/configs/tqma8mx.h
index 8ec38eced4..4c178c674a 100644
--- a/include/configs/tqma8mx.h
+++ b/include/configs/tqma8mx.h
@@ -245,19 +245,27 @@
 
 #define CONFIG_IMX_BOOTAUX
 
-#define CONFIG_CMD_MMC
+/* #define CONFIG_CMD_MMC */
 #define CONFIG_FSL_ESDHC
 #define CONFIG_FSL_USDHC
 
-#define CONFIG_SYS_FSL_USDHC_NUM	2
+/* #define CONFIG_SYS_FSL_USDHC_NUM	2 */
 #define CONFIG_SYS_FSL_ESDHC_ADDR       0
 
+/*
+#define CONFIG_DOS_PARTITION
+#define CONFIG_CMD_EXT2
+#define CONFIG_CMD_EXT4
+#define CONFIG_CMD_EXT4_WRITE
+#define CONFIG_CMD_FAT
+*/
+
 #define CONFIG_SUPPORT_EMMC_BOOT	/* eMMC specific */
 #define CONFIG_SYS_MMC_IMG_LOAD_PART	1
 
 #define CONFIG_FSL_QSPI    /* enable the QUADSPI driver */
 #ifdef CONFIG_FSL_QSPI
-#define CONFIG_CMD_SF
+/* #define CONFIG_CMD_SF */
 #define	CONFIG_SPI_FLASH
 #define	CONFIG_SPI_FLASH_STMICRO
 #define	CONFIG_SPI_FLASH_BAR
@@ -287,7 +295,7 @@
 /* USB configs */
 #ifndef CONFIG_SPL_BUILD
 
-#define CONFIG_CMD_USB
+/* #define CONFIG_CMD_USB */
 /* #define CONFIG_USB_STORAGE */
 
 /* #define CONFIG_CMD_USB_MASS_STORAGE */
@@ -296,7 +304,6 @@
 
 #endif
 
-#define CONFIG_CMD_EXT2
 #define CONFIG_USB_MAX_CONTROLLER_COUNT         2
 /* #define CONFIG_SYS_USB_XHCI_MAX_ROOT_PORTS      2 */
 
