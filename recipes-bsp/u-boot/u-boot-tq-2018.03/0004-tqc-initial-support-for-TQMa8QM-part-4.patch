From 7f5fc9507554235a3147317915f360c946201fa1 Mon Sep 17 00:00:00 2001
From: Markus Niebel <Markus.Niebel@tq-group.com>
Date: Tue, 10 Sep 2019 13:16:21 +0200
Subject: [PATCH] tqc: initial support for TQMa8QM - part 4

Signed-off-by: Markus Niebel <Markus.Niebel@tq-group.com>
---
 configs/tqma8qm_mba8x_mmc_defconfig |  8 +++++++-
 include/configs/tqma8x.h            | 11 ++++++-----
 2 files changed, 13 insertions(+), 6 deletions(-)

diff --git a/configs/tqma8qm_mba8x_mmc_defconfig b/configs/tqma8qm_mba8x_mmc_defconfig
index 044d164646..6578617ca2 100644
--- a/configs/tqma8qm_mba8x_mmc_defconfig
+++ b/configs/tqma8qm_mba8x_mmc_defconfig
@@ -12,10 +12,10 @@ CONFIG_VERSION_VARIABLE=y
 CONFIG_ARCH_MISC_INIT=y
 CONFIG_BOARD_EARLY_INIT_F=y
 CONFIG_CMD_LICENSE=y
+CONFIG_CMD_IMPORTENV=y
 CONFIG_CMD_GREPENV=y
 CONFIG_CMD_MEMINFO=y
 # CONFIG_CMD_FLASH is not set
-CONFIG_CMD_IMPORTENV=n
 CONFIG_DM=y
 
 CONFIG_OF_CONTROL=y
@@ -28,6 +28,7 @@ CONFIG_CMD_MMC=y
 CONFIG_CMD_SF=y
 CONFIG_CMD_USB=y
 CONFIG_CMD_CACHE=y
+CONFIG_CMD_LED=y
 CONFIG_CMD_EXT4_WRITE=y
 # CONFIG_ISO_PARTITION is not set
 CONFIG_ENV_IS_IN_MMC=y
@@ -47,6 +48,8 @@ CONFIG_DM_PCA953X=y
 CONFIG_DM_I2C=y
 CONFIG_DM_I2C_COMPAT=y
 CONFIG_SYS_I2C_IMX_LPI2C=y
+CONFIG_LED=y
+CONFIG_LED_GPIO=y
 CONFIG_MISC=y
 CONFIG_I2C_EEPROM=y
 CONFIG_FS_FAT=y
@@ -56,6 +59,7 @@ CONFIG_MMC_IO_VOLTAGE=y
 CONFIG_MMC_UHS_SUPPORT=y
 CONFIG_MMC_HS400_ES_SUPPORT=y
 CONFIG_MMC_HS400_SUPPORT=y
+CONFIG_FSL_ESDHC=y
 CONFIG_EFI_PARTITION=y
 CONFIG_FSL_FSPI=y
 CONFIG_DM_SPI_FLASH=y
@@ -82,11 +86,13 @@ CONFIG_DM_RTC=y
 CONFIG_RTC_DS1307=y
 CONFIG_DM_SERIAL=y
 CONFIG_FSL_LPUART=y
+# CONFIG_SERIAL_RX_BUFFER=y
 CONFIG_DM_SPI=y
 CONFIG_DM_THERMAL=y
 CONFIG_IMX_SC_THERMAL=y
 CONFIG_USB=y
 CONFIG_DM_USB=y
+CONFIG_USB_XHCI_HCD=y
 CONFIG_USB_EHCI_HCD=y
 CONFIG_MXC_USB_OTG_HACTIVE=y
 CONFIG_USB_STORAGE=y
diff --git a/include/configs/tqma8x.h b/include/configs/tqma8x.h
index 258a4f85b2..d9915c0abb 100644
--- a/include/configs/tqma8x.h
+++ b/include/configs/tqma8x.h
@@ -38,8 +38,10 @@
 #if defined(CONFIG_FSL_ESDHC)
 #define CONFIG_FSL_USDHC
 #define CONFIG_SYS_FSL_ESDHC_ADDR       0
+/*
 #define USDHC1_BASE_ADDR                0x5B010000
 #define USDHC2_BASE_ADDR                0x5B020000
+*/
 #define CONFIG_SUPPORT_EMMC_BOOT	/* eMMC specific */
 #endif
 
@@ -318,17 +320,16 @@
 #define CONFIG_SYS_SDRAM_BASE		0x80000000
 #define CONFIG_NR_DRAM_BANKS		4
 #define PHYS_SDRAM_1			0x80000000
+#define PHYS_SDRAM_2			0x880000000
 
 #if defined(CONFIG_TQMA8X_RAM_2048MB)
 #define PHYS_SDRAM_1_SIZE		SZ_2G
+/* needed for loop in CPU code */
+#define PHYS_SDRAM_2_SIZE		0x00000000	/* not placed */
 #else
 #error
 #endif
 
-/* needed for loop in CPU code */
-#define PHYS_SDRAM_2			0x880000000
-#define PHYS_SDRAM_2_SIZE		0x00000000	/* not placed */
-
 /* Serial */
 #define CONFIG_BAUDRATE			115200
 
@@ -350,7 +351,7 @@
 /* Generic Timer Definitions */
 #define COUNTER_FREQUENCY		8000000	/* 8MHz */
 
-#define CONFIG_IMX_SMMU
+/* #define CONFIG_IMX_SMMU */
 
 /* MT35XU512ABA1G12 has only one Die, so QSPI0 B won't work */
 #ifdef CONFIG_FSL_FSPI
