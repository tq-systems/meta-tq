From 3c967ea01bb4861bae2302824ef61a6fa05dac1c Mon Sep 17 00:00:00 2001
From: Max Merchel <Max.Merchel@tq-group.com>
Date: Thu, 24 Jan 2019 12:29:29 +0100
Subject: [PATCH 077/188] arm: dt: imx7-tqma7: add emmc

Signed-off-by: Max Merchel <Max.Merchel@tq-group.com>
---
 arch/arm/boot/dts/imx7-tqma7.dtsi | 62 ++++++++++++++++++++++++++++++-
 1 file changed, 61 insertions(+), 1 deletion(-)

diff --git a/arch/arm/boot/dts/imx7-tqma7.dtsi b/arch/arm/boot/dts/imx7-tqma7.dtsi
index f7caeeff8688..7e9b9b90bc2b 100644
--- a/arch/arm/boot/dts/imx7-tqma7.dtsi
+++ b/arch/arm/boot/dts/imx7-tqma7.dtsi
@@ -128,7 +128,67 @@
 				MX7D_PAD_SD2_RESET_B__GPIO5_IO11	0x4000005C
 			>;
 		};
+
+		pinctrl_usdhc3: usdhc3grp {
+			fsl,pins = <
+				MX7D_PAD_SD3_CMD__SD3_CMD		0x59
+				MX7D_PAD_SD3_CLK__SD3_CLK		0x56
+				MX7D_PAD_SD3_DATA0__SD3_DATA0		0x59
+				MX7D_PAD_SD3_DATA1__SD3_DATA1		0x59
+				MX7D_PAD_SD3_DATA2__SD3_DATA2		0x59
+				MX7D_PAD_SD3_DATA3__SD3_DATA3		0x59
+				MX7D_PAD_SD3_DATA4__SD3_DATA4		0x59
+				MX7D_PAD_SD3_DATA5__SD3_DATA5		0x59
+				MX7D_PAD_SD3_DATA6__SD3_DATA6		0x59
+				MX7D_PAD_SD3_DATA7__SD3_DATA7		0x59
+				MX7D_PAD_SD3_STROBE__SD3_STROBE		0x19
+			>;
+		};
+
+		pinctrl_usdhc3_100mhz: usdhc3grp_100mhz {
+			fsl,pins = <
+				MX7D_PAD_SD3_CMD__SD3_CMD               0x5a
+				MX7D_PAD_SD3_CLK__SD3_CLK               0x51
+				MX7D_PAD_SD3_DATA0__SD3_DATA0           0x5a
+				MX7D_PAD_SD3_DATA1__SD3_DATA1           0x5a
+				MX7D_PAD_SD3_DATA2__SD3_DATA2           0x5a
+				MX7D_PAD_SD3_DATA3__SD3_DATA3           0x5a
+				MX7D_PAD_SD3_DATA4__SD3_DATA4           0x5a
+				MX7D_PAD_SD3_DATA5__SD3_DATA5           0x5a
+				MX7D_PAD_SD3_DATA6__SD3_DATA6           0x5a
+				MX7D_PAD_SD3_DATA7__SD3_DATA7           0x5a
+				MX7D_PAD_SD3_STROBE__SD3_STROBE         0x1a
+			>;
+		};
+
+		pinctrl_usdhc3_200mhz: usdhc3grp_200mhz {
+			fsl,pins = <
+				MX7D_PAD_SD3_CMD__SD3_CMD               0x5b
+				MX7D_PAD_SD3_CLK__SD3_CLK               0x51
+				MX7D_PAD_SD3_DATA0__SD3_DATA0           0x5b
+				MX7D_PAD_SD3_DATA1__SD3_DATA1           0x5b
+				MX7D_PAD_SD3_DATA2__SD3_DATA2           0x5b
+				MX7D_PAD_SD3_DATA3__SD3_DATA3           0x5b
+				MX7D_PAD_SD3_DATA4__SD3_DATA4           0x5b
+				MX7D_PAD_SD3_DATA5__SD3_DATA5           0x5b
+				MX7D_PAD_SD3_DATA6__SD3_DATA6           0x5b
+				MX7D_PAD_SD3_DATA7__SD3_DATA7           0x5b
+				MX7D_PAD_SD3_STROBE__SD3_STROBE         0x1b
+			>;
+		};
 	};
 };
 
-
+&usdhc3 {
+	pinctrl-names = "default", "state_100mhz", "state_200mhz";
+	pinctrl-0 = <&pinctrl_usdhc3>;
+	pinctrl-1 = <&pinctrl_usdhc3_100mhz>;
+	pinctrl-2 = <&pinctrl_usdhc3_200mhz>;
+	assigned-clocks = <&clks IMX7D_USDHC3_ROOT_CLK>;
+	assigned-clock-rates = <400000000>;
+	bus-width = <8>;
+	non-removable;
+	vmmc-supply = <&vgen4_reg>;
+	vqmmc-supply = <&sw2_reg>;
+	status = "okay";
+};
